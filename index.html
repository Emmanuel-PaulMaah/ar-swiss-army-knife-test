<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AR Swiss Army Knife Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; line-height: 1.5; }
    .status { font-weight: bold; }
    .supported { color: green; }
    .unsupported { color: red; }
  </style>
</head>
<body>
  <h1>AR Swiss Army Knife Test</h1>
  <ul id="results"></ul>

  <script>
    const resultsEl = document.getElementById('results');

    function addResult(label, supported, info = '') {
      const li = document.createElement('li');
      li.innerHTML = `${label}: <span class="status ${supported ? 'supported' : 'unsupported'}">${supported ? '✅ Supported' : '❌ Not Supported'}</span> ${info}`;
      resultsEl.appendChild(li);
    }

    // 1. Secure Context
    addResult('HTTPS / Secure Context', window.isSecureContext);

    // 2. WebXR API existence
    const xrAvailable = !!navigator.xr;
    addResult('WebXR API available', xrAvailable);

    // 3. Device type
    const ua = navigator.userAgent;
    const isAndroid = /Android/i.test(ua);
    const isIOS = /iPhone|iPad|iPod/i.test(ua);
    addResult('Device type', true, isAndroid ? 'Android' : isIOS ? 'iOS' : 'Other');

    // 4. immersive-ar session support
    if (xrAvailable) {
      navigator.xr.isSessionSupported('immersive-ar')
        .then(supported => {
          addResult('immersive-ar session support', supported);
        })
        .catch(err => addResult('immersive-ar session support', false, `Error: ${err}`));
    } else {
      addResult('immersive-ar session support', false, 'WebXR not available');
    }

    // 5. Camera permissions
    async function checkCamera() {
      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        try {
          await navigator.mediaDevices.getUserMedia({ video: true });
          addResult('Camera access', true);
        } catch (err) {
          addResult('Camera access', false, `Error: ${err.message}`);
        }
      } else {
        addResult('Camera access', false, 'getUserMedia not supported');
      }
    }
    checkCamera();

    // 6. Motion / orientation sensors
    function checkMotionSensors() {
      let motionSupported = false;
      function handleMotion(e) { motionSupported = true; window.removeEventListener('devicemotion', handleMotion); }
      window.addEventListener('devicemotion', handleMotion);
      setTimeout(() => {
        addResult('Device motion/orientation sensors', motionSupported);
      }, 500);
    }
    checkMotionSensors();

    // 7. WebGL support (basic check for renderer)
    function isWebGLSupported() {
      try {
        const canvas = document.createElement('canvas');
        return !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));
      } catch(e) { return false; }
    }
    addResult('WebGL support', isWebGLSupported());

    // 8. CORS-friendly asset loading (simple test)
    async function checkCORS() {
      try {
        const response = await fetch('https://raw.githubusercontent.com/github/gitignore/main/Node.gitignore', { method: 'HEAD', mode: 'cors' });
        addResult('CORS access test', response.ok, 'Example asset from GitHub raw');
      } catch(err) {
        addResult('CORS access test', false, `Error: ${err.message}`);
      }
    }
    checkCORS();

    // 9. Full screen support
    addResult('Fullscreen API', !!(document.fullscreenEnabled || document.webkitFullscreenEnabled));
  </script>
</body>
</html>
